<!DOCTYPE html>
<html>
  <head>
  <meta charset=utf-8 />
  <title>  MCB111 Mathematics in Biology </title>
  <link rel="stylesheet" href="/Harvard-MCB111-2024-Fall/css/style.css" />
</head>

<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<body>
  <div id="main">
 
    <header>
      <h3> MCB111: Mathematics in Biology (Fall 2024) </h3>
    </header>
 
    <nav role="navigation"> 
      <a href="/Harvard-MCB111-2024-Fall">Home</a>  | <a href="/Harvard-MCB111-2024-Fall/schedule.html">Schedule</a> | <a href="https://canvas.harvard.edu/courses/139673/">Canvas</a> | <a href="https://piazza.com/harvard/fall2024/mcb111">Piazza</a> | <a href="/Harvard-MCB111-2024-Fall/downloads/MCB111-syllabus.pdf">Syllabus [PDF]</a> | <a href="/Harvard-MCB111-2024-Fall/downloads/StudentHours_2024.pdf">Student hours schedule [PDF]</a> <br/>
      
      Lectures:
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-lecture.html"> w00 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-lecture.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-lecture.html"> w02 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-lecture.html"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-lecture.html"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-lecture.html"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-lecture.html"> w06 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-lecture.html"> w07 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-lecture.html"> w08 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-lecture.html"> w09 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-lecture.html"> w10 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w11/w11-lecture.html"> w11 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w12/w12-lecture.html"> w12 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w13/w13-lecture.html"> w13 </a> |
      <br/>
      
      inclass-notes:
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-notes-lecture1.pdf"> w02-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-notes-lecture2.pdf"> w02-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-notes-lecture1.pdf"> w03-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-notes-l1.pdf"> w04-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-notes-lectures.pdf"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-notes-l1.pdf"> w06-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-notes-l2.pdf"> w06-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-notes-l1.pdf"> w07-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-notes-l2.pdf"> w07-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-notes-l1.pdf"> w08-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-notes-l2.pdf"> w08-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-notes-l1.pdf"> w09-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-notes-l2.pdf"> w09-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-notes-l1.pdf"> w10-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-notes-l2.pdf"> w10-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-notes-l3.pdf"> w10-l3 </a> |
       <br/>
      
      inclass-code: 
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-inclass.html"> w00 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-sections_er_2024_complete.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-lecture1.html"> w02-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-lecture2.html"> w02-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-lecture-code.ipynb"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-lecture-code.ipynb"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w13/w13-code.ipynb"> w13 </a> |
      <br/>
      
      Sections: 
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-sections.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-sections.html"> w02 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-sections_NH_2024.ipynb"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-sections_2024.ipynb"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-sections_2024.ipynb"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-sections_2024.ipynb"> w08 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-sections_2024-ER.ipynb"> w09 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-sections_2024-NH.ipynb"> w10 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w11/w11-sections_2024_er.ipynb"> w11 </a> |
     <br/>
      
      
      Homeworks:
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-homework.html"> w00 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-homework.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-homework.html"> w02 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-homework.html"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-homework.html"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-homework.html"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-homework.html"> w06 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-homework.html"> w07 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-homework.html"> w08 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-homework.html"> w09 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-homework.html"> w10 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w11/w11-homework.html"> w11 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w13/w13-homework.html"> w13 </a> |
     <br/>
      
      Hints: 
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-hints.html"> w00 </a> |
      <br/>
      

      Final:
      <br/>
 
     </nav>
    
    <br/>
 
    <ul id="markdown-toc">
  <li><a href="#question-1" id="markdown-toc-question-1">Question 1</a>    <ul>
      <li><a href="#part-1-visually-assessing-the-data" id="markdown-toc-part-1-visually-assessing-the-data">part 1: Visually assessing the data</a></li>
      <li><a href="#part-2-statistical-testing" id="markdown-toc-part-2-statistical-testing">part 2: statistical testing</a>        <ul>
          <li><a href="#step-1-set-a-threshold" id="markdown-toc-step-1-set-a-threshold">step 1: set a threshold</a></li>
          <li><a href="#step-2-calculate-p-value" id="markdown-toc-step-2-calculate-p-value">step 2: calculate p value</a></li>
          <li><a href="#step-3-calculate-f" id="markdown-toc-step-3-calculate-f">step 3: calculate F*</a></li>
          <li><a href="#step-4-fdr" id="markdown-toc-step-4-fdr">step 4: FDR</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#question-2" id="markdown-toc-question-2">Question 2</a>    <ul>
      <li><a href="#part-1-draw-histograms" id="markdown-toc-part-1-draw-histograms">part 1: Draw histograms</a></li>
      <li><a href="#part-2-any-observation" id="markdown-toc-part-2-any-observation">part 2: any observation?</a></li>
      <li><a href="#data2" id="markdown-toc-data2">Data.2</a>        <ul>
          <li><a href="#test-1-whether-neurons-in-data2-have-higher-frequency" id="markdown-toc-test-1-whether-neurons-in-data2-have-higher-frequency">Test 1: whether neurons in data.2 have higher frequency</a></li>
          <li><a href="#test-2-whether-neurons-in-data2-have-lower-frequency" id="markdown-toc-test-2-whether-neurons-in-data2-have-lower-frequency">Test 2: whether neurons in data.2 have lower frequency</a></li>
        </ul>
      </li>
      <li><a href="#data3" id="markdown-toc-data3">Data.3</a></li>
    </ul>
  </li>
</ul>

<h1 class="no_toc" id="week-04">week 04:</h1>

<p>(this homework has <strong>20p</strong> in total)</p>

<p>The main code for this homework is attached here: <a href="Answer_w04.m">Code</a></p>

<p>Two functions to do quick hypothesis testing:
<a href="ans_w04_TestHigher.m">test-higher</a> and <a href="ans_w04_TestLower.m">test-lower
</a></p>

<h2 id="question-1">Question 1</h2>

<h3 id="part-1-visually-assessing-the-data">part 1: Visually assessing the data</h3>

<p>We can see that a handful of dopaminergic neurons appear to fire at
greater frequencies ~20-26Hz when rewards are less than expected
(Data.1) than when rewards are as expected (Data.0). Meanwhile, the
majority of neurons fire similarly to those in Data.1 and appear to be
even more tightly distributed about the same mean at ~15Hz.</p>

<figure><img align="mid" src="Histogram1.png" width="400" /><figcaption>Histograms for Data.0 (blue) and Data.1 (red)</figcaption></figure>

<p>(<strong>2p</strong> for histogram plots, <strong>2p</strong> for observations)</p>

<h3 id="part-2-statistical-testing">part 2: statistical testing</h3>

<p>After establishing a sense of the data, we can start placing
thresholds and determining how well they distinguish the neurons that
behave uniquely in Data.1. For a given cutoff of the frequency, we can
assess the splitting of the data (and number of neurons classified as
unique) with a few convenient metrics: the p-value, false discovery
rate, and sensitivity.</p>

<p>For instance, we might observe that Data.1 seems to have more neurons
firing at 17Hz or higher, and so choose to set a cut-off of 17Hz for
the identification of neurons that correspond to the smaller reward
response. With the p-value, we ask “under the null, what is the
probability of measuring a frequency above the cutoff?”</p>

<h4 id="step-1-set-a-threshold">step 1: set a threshold</h4>
<p>We will consider the condition of expected reward as our null. So to
approximate the probability of a null measurement falling above the
cutoff, Let’s consider the cutoff:</p>

\[cutoff^* = 17\]

<p>Which is equivalent to \(sc*\) mentioned in lecture.</p>

<h4 id="step-2-calculate-p-value">step 2: calculate p value</h4>

<p>In this case, the null dataset is “Data.0”, therefore:</p>

\[n_0^* = sum(Data.0 &gt;= cutoff^*);\]

<p>% total instances of Data.0 values greater than 17 -&gt; 19</p>

<p>Therefore the definition of \(p^*\), where N_0 is total sample size of Data.0:</p>

\[p^* = n_0^* / N_0 = sum(Data.0 &gt;= cutoff^*) / N_0\]

<p>% p value given cutoff=17 -&gt; 0.008168</p>

<h4 id="step-3-calculate-f">step 3: calculate F*</h4>

<p>The dataset you want to test is “Data.1”, therefore the F* should be:</p>

\[F^* = sum(Data.1&gt;=cutoff^*);\]

<p>% totals the instances of data.1 values greater than 17 -&gt; 7</p>

<p>At the same time, we can also calculate the sensitivity, where \(N_1\) is sample size of Data.1:</p>

\[Sensitivity = F^* / N_1 = sum(Data.1&gt;=cutoff^*) / N_1\]

<p>% sensitivity given cutoff=17 -&gt; 7 / 872 = 0.021789</p>

<h4 id="step-4-fdr">step 4: FDR</h4>

<p>Now we are ready to calculate FDR. Since Data.1 is the dataset you want to test
the \(N\) in definition of FDR should be size of Data.1:</p>

\[FDR = \frac{N_1 * p^*}{F^*}\]

<p>% FDR given cutoff=17 -&gt; 0.37487</p>

<p>Using Data.0 as our null hypothesis. Cutting Data.1 at 17Hz,
identifies 19 neurons as firing differently than the null with a
p-value of 0.008168, false discovery rate of 37.5%, and sensitivity of
2.18%.</p>

<p>You can essentially increase this threshold and the result is as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fr     F     n0        p          FDR       Sensitivity
____    __    __    _________    ________    ___________

  16    25    52     0.060677      2.1164     0.02867   
16.2    23    41     0.047841      1.8138    0.026376   
16.4    19    29     0.033839       1.553    0.021789   
16.6    19    20     0.023337      1.0711    0.021789   
16.8    19    13     0.015169     0.69619    0.021789   
  17    19     7     0.008168     0.37487    0.021789   
17.2    19     7     0.008168     0.37487    0.021789   
17.4    19     3    0.0035006     0.16066    0.021789   
17.6    18     2    0.0023337     0.11306    0.020642   
17.8    18     1    0.0011669    0.056528    0.020642   
  18    18     1    0.0011669    0.056528    0.020642   
</code></pre></div></div>

<p>By increasing our cutoff to 17.8Hz we can improve our p-value to
0.00117 and FDR to 5.65% without much penalty to our sensitivity, now
2.06%.</p>

<p>This cutoff seems to only allow us to identify a small fraction of
neurons in the low-reward response. However, choosing 17.8Hz allows us
to be confident that the neurons we measure above the cutoff are
unique from the null response. If we chose a lower cutoff in order to
improve our sensitivity, the meaningfulness of our distinction would
quickly be reduced as the false discovery rate rapidly rises. In these
experiments, it is therefore important to choose a high cutoff 17.8Hz
or greater, and to take many measurements in order to ensure we
observe neurons within our sensitivity.</p>

<p>(<strong>4p</strong> for implementation, <strong>2p</strong> for reasonable p-values, <strong>2p</strong> for observations)</p>

<h2 id="question-2">Question 2</h2>

<h3 id="part-1-draw-histograms">part 1: Draw histograms</h3>

<p>Here, we repeat the process of part A and part B in order to identify
and evaluate reasonable cutoffs for distinguishing the new data from the null.</p>

<p><img align="mid" src="Histogram2.png" width="400" /></p>

<p><em>Equivalently bined histograms for Data.0 (blue) and Data.2 (red)</em></p>

<p><img align="mid" src="Histogram3.png" width="400" /></p>

<p><em>Equivalently bined histograms for Data.0 (blue) and Data.3 (red)</em></p>

<h3 id="part-2-any-observation">part 2: any observation?</h3>

<h3 id="data2">Data.2</h3>

<p>It appears that Data.2 is distributed perfectly the same way as
Data.0, only having slightly fewer samples. We can try to do the same type of analysis:</p>

<h4 id="test-1-whether-neurons-in-data2-have-higher-frequency">Test 1: whether neurons in data.2 have higher frequency</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> fr     F     n0        p         FDR      Sensitivity
____    __    __    _________    ______    ___________

  16    49    52     0.060677    1.0352     0.058612  
16.2    39    41     0.047841    1.0255     0.046651  
16.4    27    29     0.033839    1.0478     0.032297  
16.6    19    20     0.023337    1.0268     0.022727  
16.8    12    13     0.015169    1.0568     0.014354  
  17     7     7     0.008168    0.9755    0.0083732  
17.2     7     7     0.008168    0.9755    0.0083732  
17.4     3     3    0.0035006    0.9755    0.0035885  
17.6     2     2    0.0023337    0.9755    0.0023923  
17.8     1     1    0.0011669    0.9755    0.0011962  
  18     1     1    0.0011669    0.9755    0.0011962  
</code></pre></div></div>

<p>The False Discover Rate is always high in all chosen cutoffs, therefore the neurons in data.2 don’t have higher frequencies.</p>

<h4 id="test-2-whether-neurons-in-data2-have-lower-frequency">Test 2: whether neurons in data.2 have lower frequency</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  fr       F     n0         p          FDR      Sensitivity
______    ___    ___    _________    _______    ___________

    13      0      0            0        NaN            0  
13.333      0      0            0        NaN            0  
13.667      3      3    0.0035006     0.9755    0.0035885  
    14     26     28     0.032672     1.0505       0.0311  
14.333     74     79     0.092182     1.0414     0.088517  
14.667    219    229      0.26721       1.02      0.26196  
    15    471    485      0.56593     1.0045       0.5634  
15.333    643    659      0.76896    0.99977      0.76914  
15.667    736    754      0.87981    0.99935      0.88038  
    16    787    805      0.93932    0.99781      0.94139  
</code></pre></div></div>

<p>Therefore similarly, neurons in data.2 don’t have lower frequencies
compared to data.0. There is no evidence that neurons in data.2 fire
differently compared with data.0.</p>

<h3 id="data3">Data.3</h3>

<p>According to histogram, there are some neurons in data.3 has lower
frequency compared with data.0. To verify this observation we tested
whether neurons in data.3 has lower frequency:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fr     F     n0        p          FDR      Sensitivity
__    ___    ___    ________    _______    ___________

 6      2      0           0          0    0.0023392  
 7      3      0           0          0    0.0035088  
 8      4      0           0          0    0.0046784  
 9     10      0           0          0     0.011696  
10     13      0           0          0     0.015205  
11     18      0           0          0     0.021053  
12     18      0           0          0     0.021053  
13     19      0           0          0     0.022222  
14     25     28    0.032672     1.1174      0.02924  
15    494    485     0.56593    0.97949      0.57778  
</code></pre></div></div>

<p>It turns out that \(13\) is a pretty good cutoff. This result
indicates that a certain subgroup of neurons in data.3 have lower
firing frequencies compared with data.0.</p>

<p>(<strong>2p</strong> for histograms, or any other kinds of visualization, 
<strong>2p</strong> for p-values/FDR/sensitivity,
<strong>4p</strong> for valid claims about data.2 and data.3.
If there are valid conclusions but no statistical testing at all, <strong>2p</strong> will be removed)</p>

 
    <footer>
      <hr>
      <p>
        <a href="http://rivaslab.org">Elena Rivas</a> | Harvard University
    </footer>
 
  </div>
</body>
</html>
