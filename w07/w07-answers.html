<!DOCTYPE html>
<html>
  <head>
  <meta charset=utf-8 />
  <title>  MCB111 Mathematics in Biology </title>
  <link rel="stylesheet" href="/css/style.css" />
</head>

<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<body>
  <div id="main">
 
    <header>
      <h3> MCB111: Mathematics in Biology (Fall 2024) </h3>
    </header>
 
    <nav role="navigation"> 
      <a href="/">Home</a>  | <a href="/schedule.html">Schedule</a> | <a href="https://canvas.harvard.edu/courses/139673/">Canvas</a> | <a href="https://piazza.com/harvard/fall2024/mcb111">Piazza</a> | <a href="/downloads/MCB111-syllabus.pdf">Syllabus [PDF]</a> | <a href="/downloads/StudentHours_2024.pdf">Student hours schedule [PDF]</a> <br/>
      
      Lectures:
      <a href="/w00/w00-lecture.html"> w00 </a> |
      <a href="/w01/w01-lecture.html"> w01 </a> |
      <a href="/w02/w02-lecture.html"> w02 </a> |
      <a href="/w03/w03-lecture.html"> w03 </a> |
      <a href="/w04/w04-lecture.html"> w04 </a> |
      <a href="/w05/w05-lecture.html"> w05 </a> |
      <a href="/w06/w06-lecture.html"> w06 </a> |
      <a href="/w07/w07-lecture.html"> w07 </a> |
      <a href="/w08/w08-lecture.html"> w08 </a> |
      <a href="/w09/w09-lecture.html"> w09 </a> |
      <a href="/w10/w10-lecture.html"> w10 </a> |
      <a href="/w11/w11-lecture.html"> w11 </a> |
      <a href="/w12/w12-lecture.html"> w12 </a> |
      <a href="/w13/w13-lecture.html"> w13 </a> |
      <br/>
      
      inclass-notes:
      <a href="/w02/w02-notes-lecture1.pdf"> w02-l1 </a> |
      <a href="/w02/w02-notes-lecture2.pdf"> w02-l2 </a> |
      <a href="/w03/w03-notes-lecture1.pdf"> w03-l1 </a> |
      <a href="/w04/w04-notes-l1.pdf"> w04-l1 </a> |
      <a href="/w05/w05-notes-lectures.pdf"> w05 </a> |
      <a href="/w06/w06-notes-l1.pdf"> w06-l1 </a> |
      <a href="/w06/w06-notes-l2.pdf"> w06-l2 </a> |
      <a href="/w07/w07-notes-l1.pdf"> w07-l1 </a> |
      <a href="/w07/w07-notes-l2.pdf"> w07-l2 </a> |
      <a href="/w08/w08-notes-l1.pdf"> w08-l1 </a> |
      <a href="/w08/w08-notes-l2.pdf"> w08-l2 </a> |
      <a href="/w09/w09-notes-l1.pdf"> w09-l1 </a> |
      <a href="/w09/w09-notes-l2.pdf"> w09-l2 </a> |
      <a href="/w10/w10-notes-l1.pdf"> w10-l1 </a> |
      <a href="/w10/w10-notes-l2.pdf"> w10-l2 </a> |
      <a href="/w10/w10-notes-l3.pdf"> w10-l3 </a> |
       <br/>
      
      inclass-code: 
      <a href="/w00/w00-inclass.html"> w00 </a> |
      <a href="/w01/w01-sections_er_2024_complete.html"> w01 </a> |
      <a href="/w02/w02-lecture1.html"> w02-l1 </a> |
      <a href="/w02/w02-lecture2.html"> w02-l2 </a> |
      <a href="/w03/w03-lecture-code.ipynb"> w03 </a> |
      <a href="/w04/w04-lecture-code.ipynb"> w04 </a> |
      <a href="/w13/w13-code.ipynb"> w13 </a> |
      <br/>
      
      Sections: 
      <a href="/w01/w01-sections.html"> w01 </a> |
      <a href="/w02/w02-sections.html"> w02 </a> |
      <a href="/w03/w03-sections_NH_2024.ipynb"> w03 </a> |
      <a href="/w04/w04-sections_2024.ipynb"> w04 </a> |
      <a href="/w05/w05-sections_2024.ipynb"> w05 </a> |
      <a href="/w08/w08-sections_2024.ipynb"> w08 </a> |
      <a href="/w09/w09-sections_2024-ER.ipynb"> w09 </a> |
      <a href="/w10/w10-sections_2024-NH.ipynb"> w10 </a> |
      <a href="/w11/w11-sections_2024_er.ipynb"> w11 </a> |
     <br/>
      
      
      Homeworks:
      <a href="/w00/w00-homework.html"> w00 </a> |
      <a href="/w01/w01-homework.html"> w01 </a> |
      <a href="/w02/w02-homework.html"> w02 </a> |
      <a href="/w03/w03-homework.html"> w03 </a> |
      <a href="/w04/w04-homework.html"> w04 </a> |
      <a href="/w05/w05-homework.html"> w05 </a> |
      <a href="/w06/w06-homework.html"> w06 </a> |
      <a href="/w07/w07-homework.html"> w07 </a> |
      <a href="/w08/w08-homework.html"> w08 </a> |
      <a href="/w09/w09-homework.html"> w09 </a> |
      <a href="/w10/w10-homework.html"> w10 </a> |
      <a href="/w11/w11-homework.html"> w11 </a> |
      <a href="/w13/w13-homework.html"> w13 </a> |
     <br/>
      
      Hints: 
      <a href="/w00/w00-hints.html"> w00 </a> |
      <br/>
      

      Final:
      <br/>
 
     </nav>
    
    <br/>
 
    <ul id="markdown-toc">
  <li><a href="#1-algorithm" id="markdown-toc-1-algorithm">1. algorithm</a></li>
  <li><a href="#3-results" id="markdown-toc-3-results">3. Results</a></li>
</ul>

<h1 class="no_toc" id="week-07">week 07:</h1>

<p>(This homework has <strong>20p</strong> in total)</p>

<p>Code for this homework is available <a href="Answer_w07.m">Here</a></p>

<h3 id="1-algorithm">1. algorithm</h3>

<ul>
  <li>
    <p><em>start</em></p>

    <p>One starts with some arbitrary value of the parameters.</p>
  </li>
  <li>
    <p>For our case with one parameter</p>

\[p^{(0)}.\]

    <ul>
      <li><em>E-step (expectation)</em></li>
    </ul>

    <p><a href="ans_w07_logpx.m">code for log probability at each base</a></p>

    <p><a href="ans_w07_forward.m">code for forward probability</a></p>

    <p><a href="ans_w07_backward.m">code for reverse probability</a></p>

    <p><a href="ans_w07_expectation.m">code for expectation</a></p>

    <p>In this step you calculate the expected number of times each of the
 transitions is used in each locus, assuming that you sum to all other
 possible values of the ancestry for all other loci. That is</p>

\[\begin{aligned}
 E_i(AB\rightarrow AB)   &amp;= P(X_i\ldots X_{i-1}, X_i Z_i = AB, X_{i+1} Z_{i+1} = AB, X_{i+2}\ldots X_{L}\mid p^{(0)})\\
 E_i(BB\rightarrow BB)   &amp;= P(X_i\ldots X_{i-1}, X_i Z_i = BB, X_{i+1} Z_{i+1} = BB, X_{i+2}\ldots X_{L}\mid p^{(0)})\\
 E_i(AB\rightarrow BB)   &amp;= P(X_i\ldots X_{i-1}, X_i Z_i = AB, X_{i+1} Z_{i+1} = BB, X_{i+2}\ldots X_{L}\mid p^{(0)})\\
 E_i(BB\rightarrow AB)   &amp;= P(X_i\ldots X_{i-1}, X_i Z_i = BB, X_{i+1} Z_{i+1} = AB, X_{i+2}\ldots X_{L}\mid p^{(0)})\\
 \end{aligned}\]

    <p>These <em>expected counts</em>  are the equivalent of the counts in the case of having labeled data.</p>

    <p>The expected counts are easily calculated from the forward and backward probabilities calculated using
 the forward and backward algorithms introduced in <a href="../w06/w06-lecture.html">week 06</a> as</p>

\[\begin{aligned}
 E_i(AB\rightarrow AB)   &amp;= f_{i}^{AB}\ p^{(0)}\ P(X_{i+1}\mid AB)\ b_{i+1}^{AB}\\
 E_i(BB\rightarrow BB)   &amp;= f_{i}^{BB}\ p^{(0)}\ P(X_{i+1}\mid BB)\ b_{i+1}^{BB}\\
 E_i(AB\rightarrow BB)   &amp;= f_{i}^{AB}\ (1-p^{(0)})\ P(X_{i+1}\mid BB)\ b_{i+1}^{BB}\\
 E_i(BB\rightarrow AB)   &amp;= f_{i}^{BB}\ (1-p^{(0)})\ P(X_{i+1}\mid AB)\ b_{i+1}^{AB}\\
 \end{aligned}\]

    <ul>
      <li><em>M-step (maximization)</em></li>
    </ul>

    <p><a href="ans_w07_maximization.m">code for maximization</a></p>

\[p^{(1)} = \frac{\sum_m\sum_i E^m_i(AB\rightarrow AB) + \sum_m\sum_i E^m_i(BB\rightarrow BB)}
 {[\sum_m\sum_i E^m_i(AB\rightarrow AB)+\sum_m\sum_i E^m_i(BB\rightarrow BB)]+[\sum_m\sum_i E^m_i(AB\rightarrow BB)+\sum_m\sum_i E^m_i(BB\rightarrow AB)]}\]

    <p>The new \(p^{(1)}\) are used  for a new round of the <em>E-step</em></p>
  </li>
  <li>
    <p><em>end</em></p>

    <p>We iterate the E-step/M-step until convergence, that is \(p^{(n)} \approx p^{(n+1)}\).</p>

    <table>
      <tbody>
        <tr>
          <td>in this case, we stop iteration when $$</td>
          <td>p^{(n)}- p^{(n+1)}</td>
          <td>&lt; 10^{-4}$$.</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h3 id="3-results">3. Results</h3>

<div id="figcontainer">
   <div id="figure">
     <img src="traces.png" style="width:400px;" /> <br />
     Figure 1. values for parameter $$p$$ calculated by EM algorithm, where 3 different initial values were shown
   </div>
 </div>

<ul>
  <li>According to results, the final p converges to ~ \(0.99957\), which means about \(43\) breakpoints appears.</li>
</ul>

 
    <footer>
      <hr>
      <p>
        <a href="http://rivaslab.org">Elena Rivas</a> | Harvard University
    </footer>
 
  </div>
</body>
</html>
