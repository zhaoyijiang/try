<!DOCTYPE html>
<html>
  <head>
  <meta charset=utf-8 />
  <title>  MCB111 Mathematics in Biology </title>
  <link rel="stylesheet" href="/css/style.css" />
</head>

<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<body>
  <div id="main">
 
    <header>
      <h3> MCB111: Mathematics in Biology (Fall 2024) </h3>
    </header>
 
    <nav role="navigation"> 
      <a href="/Harvard-MCB111-2024-Fall">Home</a>  | <a href="/Harvard-MCB111-2024-Fall/schedule.html">Schedule</a> | <a href="https://canvas.harvard.edu/courses/139673/">Canvas</a> | <a href="https://piazza.com/harvard/fall2024/mcb111">Piazza</a> | <a href="/Harvard-MCB111-2024-Fall/downloads/MCB111-syllabus.pdf">Syllabus [PDF]</a> | <a href="/Harvard-MCB111-2024-Fall/downloads/StudentHours_2024.pdf">Student hours schedule [PDF]</a> <br/>
      
      Lectures:
      <a href="/w00/w00-lecture.html"> w00 </a> |
      <a href="/w01/w01-lecture.html"> w01 </a> |
      <a href="/w02/w02-lecture.html"> w02 </a> |
      <a href="/w03/w03-lecture.html"> w03 </a> |
      <a href="/w04/w04-lecture.html"> w04 </a> |
      <a href="/w05/w05-lecture.html"> w05 </a> |
      <a href="/w06/w06-lecture.html"> w06 </a> |
      <a href="/w07/w07-lecture.html"> w07 </a> |
      <a href="/w08/w08-lecture.html"> w08 </a> |
      <a href="/w09/w09-lecture.html"> w09 </a> |
      <a href="/w10/w10-lecture.html"> w10 </a> |
      <a href="/w11/w11-lecture.html"> w11 </a> |
      <a href="/w12/w12-lecture.html"> w12 </a> |
      <a href="/w13/w13-lecture.html"> w13 </a> |
      <br/>
      
      inclass-notes:
      <a href="/w02/w02-notes-lecture1.pdf"> w02-l1 </a> |
      <a href="/w02/w02-notes-lecture2.pdf"> w02-l2 </a> |
      <a href="/w03/w03-notes-lecture1.pdf"> w03-l1 </a> |
      <a href="/w04/w04-notes-l1.pdf"> w04-l1 </a> |
      <a href="/w05/w05-notes-lectures.pdf"> w05 </a> |
      <a href="/w06/w06-notes-l1.pdf"> w06-l1 </a> |
      <a href="/w06/w06-notes-l2.pdf"> w06-l2 </a> |
      <a href="/w07/w07-notes-l1.pdf"> w07-l1 </a> |
      <a href="/w07/w07-notes-l2.pdf"> w07-l2 </a> |
      <a href="/w08/w08-notes-l1.pdf"> w08-l1 </a> |
      <a href="/w08/w08-notes-l2.pdf"> w08-l2 </a> |
      <a href="/w09/w09-notes-l1.pdf"> w09-l1 </a> |
      <a href="/w09/w09-notes-l2.pdf"> w09-l2 </a> |
      <a href="/w10/w10-notes-l1.pdf"> w10-l1 </a> |
      <a href="/w10/w10-notes-l2.pdf"> w10-l2 </a> |
      <a href="/w10/w10-notes-l3.pdf"> w10-l3 </a> |
       <br/>
      
      inclass-code: 
      <a href="/w00/w00-inclass.html"> w00 </a> |
      <a href="/w01/w01-sections_er_2024_complete.html"> w01 </a> |
      <a href="/w02/w02-lecture1.html"> w02-l1 </a> |
      <a href="/w02/w02-lecture2.html"> w02-l2 </a> |
      <a href="/w03/w03-lecture-code.ipynb"> w03 </a> |
      <a href="/w04/w04-lecture-code.ipynb"> w04 </a> |
      <a href="/w13/w13-code.ipynb"> w13 </a> |
      <br/>
      
      Sections: 
      <a href="/w01/w01-sections.html"> w01 </a> |
      <a href="/w02/w02-sections.html"> w02 </a> |
      <a href="/w03/w03-sections_NH_2024.ipynb"> w03 </a> |
      <a href="/w04/w04-sections_2024.ipynb"> w04 </a> |
      <a href="/w05/w05-sections_2024.ipynb"> w05 </a> |
      <a href="/w08/w08-sections_2024.ipynb"> w08 </a> |
      <a href="/w09/w09-sections_2024-ER.ipynb"> w09 </a> |
      <a href="/w10/w10-sections_2024-NH.ipynb"> w10 </a> |
      <a href="/w11/w11-sections_2024_er.ipynb"> w11 </a> |
     <br/>
      
      
      Homeworks:
      <a href="/w00/w00-homework.html"> w00 </a> |
      <a href="/w01/w01-homework.html"> w01 </a> |
      <a href="/w02/w02-homework.html"> w02 </a> |
      <a href="/w03/w03-homework.html"> w03 </a> |
      <a href="/w04/w04-homework.html"> w04 </a> |
      <a href="/w05/w05-homework.html"> w05 </a> |
      <a href="/w06/w06-homework.html"> w06 </a> |
      <a href="/w07/w07-homework.html"> w07 </a> |
      <a href="/w08/w08-homework.html"> w08 </a> |
      <a href="/w09/w09-homework.html"> w09 </a> |
      <a href="/w10/w10-homework.html"> w10 </a> |
      <a href="/w11/w11-homework.html"> w11 </a> |
      <a href="/w13/w13-homework.html"> w13 </a> |
     <br/>
      
      Hints: 
      <a href="/w00/w00-hints.html"> w00 </a> |
      <br/>
      

      Final:
      <br/>
 
     </nav>
    
    <br/>
 
    <ul id="markdown-toc">
  <li><a href="#motivation-for-the-logistic-function" id="markdown-toc-motivation-for-the-logistic-function">Motivation for the logistic function</a>    <ul>
      <li><a href="#the-noisy-led-display" id="markdown-toc-the-noisy-led-display">The noisy LED display</a></li>
      <li><a href="#solution" id="markdown-toc-solution">Solution</a></li>
    </ul>
  </li>
</ul>

<h1 class="no_toc" id="week-08">week 08:</h1>

<h1 class="no_toc" id="neural-networks---learning-as-inference">Neural Networks - Learning as Inference</h1>

<h2 id="motivation-for-the-logistic-function">Motivation for the logistic function</h2>

<p>The logistic function appears in problems where there is a binary
decision to make.  Here you will workout a problem (based on
MacKays’s exercise 39.5) that like a binary neuron, also uses a
logistic function.</p>

<h3 id="the-noisy-led-display">The noisy LED display</h3>

<div id="figcontainer">
  <div id="figure">
     <img src="noisyLED.png" style="width:300px;" /> <br />
     Figure 1. The noisy LED. Figure extracted from MacKay's Chapter 39.
     </div>
</div>

<p>In a LED display each number corresponds to a pattern of on(1) or off(0) for
the 7 different elements that compose the display.
For instance,  the patterns for numbers 2 and 3 are:</p>

\[\mathbf{c}(2) = (1,0,1,1,1,0,1)\]

\[\mathbf{c}(3) = (1,0,1,1,0,1,1)\]

<p>Imagine you have a LED display that is not working properly. This
defective LED is such that, for a given number the LED wants to display:</p>

<ul>
  <li>
    <p>Elements that have to be off, are wrongly on with probability \(f\).</p>
  </li>
  <li>
    <p>Elements that have to be on, are actually on with probability \(1-f\),</p>
  </li>
</ul>

<p><strong>The LED is allowed to display ONLY a number “2” or a number “3”</strong>.
And it does so by emitting a patter
\(\mathbf{p}=(p1,p2,p3,p4,p5,p6,p7)\), where \(p_i = 1,0\)</p>

<p>Calculate the posterior probability that the intended number was a “2”, given the
pattern \(\mathbf{p}\) you observe in the LED, that is,</p>

\[P(n=2\mid \mathbf{p}).\]

<p>Show that you can express that posterior probability as a logistic function,</p>

\[P(n=2\mid \mathbf{p}) = \frac{1}{1+e^{-\mathbf{w}\mathbf{p} + \theta}}\]

<p>for some weights \(\mathbf{w}\), and some constant \(\theta\).</p>

<p>You can assume that the prior probabilities for either number, \(P_2\) and \(P_3\), are given.</p>

<p><em>Hint</em>: \(x^y = e^{y\log x}\) for any two real numbers \(x, y\).</p>

<h3 id="solution">Solution</h3>

<p>The probability that we can calculate is \(P(\mathbf{p}\mid 2)\), that
is the probability that observing a particular pattern \(\mathbf{p}\),
given that the LED tried to emit a “2”,</p>

\[P(\mathbf{p}\mid 2) = (1-f)^{p_1+p_3+p_4+p_5+p_7}\, f^{p2+p_6}.\]

<p>Using vector notation,</p>

\[P(\mathbf{p}\mid 2) = (1-f)^{\mathbf{c}(2)\mathbf{p}}\, f^{\mathbf{\hat c} (2)\mathbf{p}},\]

<p>where</p>

\[{\hat c}(2)_i = 1- c(2)_i.\]

<p>Then using the hint above, we can rewrite,</p>

\[\begin{aligned}
P(\mathbf{p}\mid 2)
&amp;=  e^{\log(1-f)\mathbf{c}(2)\,\mathbf{p}}\, e^{\log(f)\,\mathbf{\hat c} (2)\mathbf{p}}\\
&amp;=  e^{\log(1-f)\,\mathbf{c}(2)\mathbf{p} + \log(f)\,\mathbf{\hat c} (2)\mathbf{p}}\\
&amp;=  e^{\left[\log(1-f)\,\mathbf{c}(2) + \log(f)\,\mathbf{\hat c} (2)\right]\mathbf{p}}.\\
\end{aligned}\]

<p>Introducing the vector</p>

\[\mathbf{a}(2) = \log(1-f)\,\mathbf{c}(2) + \log(f)\,\mathbf{\hat c} (2)\]

<p>such that</p>

\[a(2)_i
= \log(1-f)\,c(2)_i + \log(f)\,\left(1-c(2)_i\right),\]

<p>we can write with all generality</p>

\[P(\mathbf{p}\mid 2) = e^{\mathbf{a}(2)\,\mathbf{p}}.\]

<p>The quantity we have been asked to calculate is not \(P(\mathbf{p}\mid
2)\), but instead, given that we have seen a pattern \(\mathbf{p}\),
what is the probability that the pattern was generated with a “2” in
mind. That is the posterior probability \(P(2\mid \mathbf{p})\), which
using Bayes theorem is given as a function of \(P(\mathbf{p}\mid 2)\)
as</p>

\[P(2\mid \mathbf{p}) = \frac{P(\mathbf{p}\mid 2) P(2)}{P(\mathbf{p})},\]

<p>where \(P(2)\) is a prior probability.</p>

<p>In the general case in which the LED can produce any of the 10 digits
(from 0 to 9), then we have by marginalization</p>

\[\begin{aligned}
P(\mathbf{p})
&amp;= P(\mathbf{p}\mid 0) P(0) + P(\mathbf{p}\mid 1) P(1) + P(\mathbf{p}\mid 2) P(2) + \ldots + P(\mathbf{p}\mid 9) P(9)\\
&amp;= \sum_{n=0}^{9} e^{\mathbf{a}(n)\,\mathbf{p}}\, P(n).
\end{aligned}\]

<p>Resulting in the general solution,</p>

\[P(2\mid \mathbf{p}) = \frac{e^{\mathbf{a}(2)\,\mathbf{p}}\, P(2)}{\sum_{n=0}^{9} e^{\mathbf{a}(n)\,\mathbf{p}}\, P(n)},\]

<p>Notice that, the normalization condition is \(\sum_{n=0}^9 P(n\mid \mathbf{p}) = 1\).</p>

<p>For our particular problem, where we want to distinguish only between the
pattern being generated by a “2” or a “3”, that results in</p>

\[P(2\mid \mathbf{p})
= \frac{e^{\mathbf{a}(2)\,\mathbf{p}}\, P(2)}{e^{\mathbf{a}(2)\,\mathbf{p}}\, P(2) + e^{\mathbf{a}(3)\,\mathbf{p}}\, P(3)},\]

<p>where here the normalization condition is</p>

\[P(2\mid \mathbf{p}) + P(3\mid \mathbf{p}) = 1.\]

<p>The posterior probability \(P(2\mid \mathbf{p})\) can be re-written as</p>

\[P(2\mid \mathbf{p}) = \frac{1}{1 + e^{\left[\mathbf{a}(3)-\mathbf{a}(2)\right]\,\mathbf{p}}\, \frac{P(3)}{P(2)}}.\]

<p>We can define the weights</p>

\[\mathbf{w} = \mathbf{a}(3)-\mathbf{a}(2).\]

<p>We can also parameterize the priors as</p>

\[\frac{P(3)}{P(2)}=e^\theta.\]

<p>For instance, \(\theta = -\log(2)\) for \(P(2) = P(3) = 1/2\).</p>

<p>Then, we have the expression we wanted to obtain of \(P(2\mid
\mathbf{p})\) as a logistic linear function</p>

\[P(2\mid \mathbf{p}) = \frac{1}{1 + e^{\mathbf{w}\,\mathbf{p} + \theta}},\]

<p>with weights,</p>

\[\begin{aligned}
w_i
&amp;= a(3)_i - a(2)_i\\
&amp;= \log(1-f)\,\left[c(3)_i - c(2)_i\right] + \log(f)\,\left[c(2)_i - c(3)_i\right]\\
&amp;=\frac{\log(1-f)}{\log f}\left[c(3)_i-c(2)_i\right]\\
\end{aligned}\]

<p>or</p>

\[\mathbf{w} = \frac{\log(1-f)}{\log f}\left(0, 0, 0, 0, -1, 1, 0\right).\]

 
    <footer>
      <hr>
      <p>
        <a href="http://rivaslab.org">Elena Rivas</a> | Harvard University
    </footer>
 
  </div>
</body>
</html>
