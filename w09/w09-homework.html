<!DOCTYPE html>
<html>
  <head>
  <meta charset=utf-8 />
  <title>  MCB111 Mathematics in Biology </title>
  <link rel="stylesheet" href="/Harvard-MCB111-2024-Fall/css/style.css" />
</head>

<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<body>
  <div id="main">
 
    <header>
      <h3> MCB111: Mathematics in Biology (Fall 2024) </h3>
    </header>
 
    <nav role="navigation"> 
      <a href="/Harvard-MCB111-2024-Fall">Home</a>  | <a href="/Harvard-MCB111-2024-Fall/schedule.html">Schedule</a> | <a href="https://canvas.harvard.edu/courses/139673/">Canvas</a> | <a href="https://piazza.com/harvard/fall2024/mcb111">Piazza</a> | <a href="/Harvard-MCB111-2024-Fall/downloads/MCB111-syllabus.pdf">Syllabus [PDF]</a> | <a href="/Harvard-MCB111-2024-Fall/downloads/StudentHours_2024.pdf">Student hours schedule [PDF]</a> <br/>
      
      Lectures:
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-lecture.html"> w00 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-lecture.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-lecture.html"> w02 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-lecture.html"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-lecture.html"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-lecture.html"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-lecture.html"> w06 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-lecture.html"> w07 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-lecture.html"> w08 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-lecture.html"> w09 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-lecture.html"> w10 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w11/w11-lecture.html"> w11 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w12/w12-lecture.html"> w12 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w13/w13-lecture.html"> w13 </a> |
      <br/>
      
      inclass-notes:
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-notes-lecture1.pdf"> w02-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-notes-lecture2.pdf"> w02-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-notes-lecture1.pdf"> w03-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-notes-l1.pdf"> w04-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-notes-lectures.pdf"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-notes-l1.pdf"> w06-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-notes-l2.pdf"> w06-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-notes-l1.pdf"> w07-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-notes-l2.pdf"> w07-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-notes-l1.pdf"> w08-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-notes-l2.pdf"> w08-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-notes-l1.pdf"> w09-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-notes-l2.pdf"> w09-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-notes-l1.pdf"> w10-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-notes-l2.pdf"> w10-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-notes-l3.pdf"> w10-l3 </a> |
       <br/>
      
      inclass-code: 
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-inclass.html"> w00 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-sections_er_2024_complete.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-lecture1.html"> w02-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-lecture2.html"> w02-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-lecture-code.ipynb"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-lecture-code.ipynb"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w13/w13-code.ipynb"> w13 </a> |
      <br/>
      
      Sections: 
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-sections.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-sections.html"> w02 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-sections_NH_2024.ipynb"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-sections_2024.ipynb"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-sections_2024.ipynb"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-sections_2024.ipynb"> w08 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-sections_2024-ER.ipynb"> w09 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-sections_2024-NH.ipynb"> w10 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w11/w11-sections_2024_er.ipynb"> w11 </a> |
     <br/>
      
      
      Homeworks:
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-homework.html"> w00 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-homework.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-homework.html"> w02 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-homework.html"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-homework.html"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-homework.html"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-homework.html"> w06 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-homework.html"> w07 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-homework.html"> w08 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-homework.html"> w09 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-homework.html"> w10 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w11/w11-homework.html"> w11 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w13/w13-homework.html"> w13 </a> |
     <br/>
      
      Hints: 
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-hints.html"> w00 </a> |
      <br/>
      

      Final:
      <br/>
 
     </nav>
    
    <br/>
 
    <ul id="markdown-toc">
  <li><a href="#preliminars" id="markdown-toc-preliminars">Preliminars</a></li>
  <li><a href="#a-more-realistic-brownian-motion-that-includes-random-steps-in-time" id="markdown-toc-a-more-realistic-brownian-motion-that-includes-random-steps-in-time">A more realistic Brownian motion that includes random steps in time</a></li>
  <li><a href="#hints" id="markdown-toc-hints">Hints</a></li>
</ul>

<h1 class="no_toc" id="week-09">week 09:</h1>

<h1 class="no_toc" id="random-walks-in-biology">Random Walks in Biology</h1>

<h2 id="preliminars">Preliminars</h2>

<p>Present all your reasoning, derivations, plots and code as part of the homework. Imagine that you are writing a short paper that anyone in class should to be able to understand.  If you are stuck in some point, please describe the issue and how far you got. A jupyter notebook if you are working in Python is not required, but recommended.</p>

<h2 id="a-more-realistic-brownian-motion-that-includes-random-steps-in-time">A more realistic Brownian motion that includes random steps in time</h2>

<p>You are going to implement a more sophisticated 1D random walk than the one
we discussed in class.</p>

<p>Particles emit from a fixed point, that we define as \(x=0\).  When
the particle moves, it does it either to the left with probability
\(p=0.5\) or to the right with probability \(q = 1-p = 0.5\). Nothing
new so far.</p>

<p>The difference is that instead of moving with the tick of a clock, the
particle can wait in a given position for a while before making the
next move.
We are going to assume that the time a particle waits at a position \(i\),
\(t_w^i\), follows a exponential distribution, that is,</p>

\[P(t^i_w = t) = \frac{e^{-t/\lambda}}{\lambda}\]

<p>where \(\lambda\) is the mean rate.</p>

<ul>
  <li>
    <p>Simulate 10 random walks assuming that \(\lambda = 0.2\ s^{-1}\) up to \(t = 200\ s\).</p>

    <p>To do this simulation, you may want to first sample the wait time using the exponential
distribution, and later decide on the direction to take.</p>

    <p>(See hint below on how to do the inverse sampling from the exponential distribution)</p>
  </li>
  <li>
    <p>Now simulate 100 walks, but instead of looking at the individual trajectories, we are
going to collect the positions at two different time points \(t_1 = 200\ s\) and \(t_2 = 800\ s\).</p>

    <p>Calculate the sample mean \(\bar{x} = \langle x\rangle\) and variance \(\langle (x-\bar{x})^2\rangle\) for
each of those times.</p>
  </li>
  <li>
    <p>Repeat the simulation, but changing the wait time constant to \(\lambda = 20.0\ s^{-1}\). Again report
the sample mean and variance.</p>

    <p>Can you infer the expressions of the mean and variance as a function of \(t\) and \(\lambda\)?</p>
  </li>
</ul>

<h2 id="hints">Hints</h2>

<ul>
  <li>
    <p>Hit about inverse sampling from the exponential distribution</p>

    <p>The probability density function (PDF) is</p>

\[PDF(t) = \frac{1}{\lambda}\ e^{-t/\lambda}.\]

    <p>In order to inverse sample a time \(t\), we used the cumulative probability function (CDF)</p>

\[CDF(t) = \int_0^{t} \frac{1}{\lambda}\ e^{-t^\prime/\lambda}\ dt^\prime\]

    <p>such that for  a random number \(0\leq x\leq 1\), the sampled \(t\) time is given by</p>

\[x = CDF(t)\quad \mbox{or}\quad t = CDF^{-1}(x).\]

    <p>The CDF of the exponential distribution has a closed form given by</p>

\[CDF(t) = \int_0^{t^\prime} \frac{1}{\lambda}\ e^{-t^\prime/\lambda} = 1 - e^{-t/\lambda}.\]

    <p>Then, the sampled time is given by</p>

\[t = -\lambda\ \log(1-x).\]

    <p>If \(x\) is a random number in \([0,1]\), then \(1-x\) is also a
 random number in the same range, then we can take the sampled 
 time \(t\) given by</p>

\[t = -\lambda\ \log(x).\]
  </li>
  <li>
    <p>A hint about last question</p>

    <p>For the simple random walks we described in class, where every time the clock ticked, there was
a  movement left or right. The number of total (left or right) moves (\(N\)) is always identical to the number of
time steps, that is \(t/\tau = N\). In other words, at a given time \(t\) all sampled trajectories
have experienced the same number \(N=t/\tau\) of left/right moves.</p>

    <p>Then the probability of being at position \(x\), after time \(t/\tau=N\) is (as we discussed in class)
given by</p>

\[P(x\mid t/\tau=N) = \frac{N!}{\left(\frac{N-x}{2}\right)!\left(\frac{N+x}{2}\right)!} \left(\frac{1}{2}\right)^N\]

    <p>where of the \(N\) total  moves, \(\frac{N-x}{2}\) where in the left direction and \(\frac{N+x}{2}\)
where in the right direction.</p>

    <p>We also derived that the mean and variance of this unbiased random walk is given by</p>

\[\begin{aligned}
\langle x\rangle &amp;= N (p-q) = 0\\
\langle x^2\rangle &amp;= 4 N pq = N.
\end{aligned}\]

    <p>That property  is not true anymore when we introduce a wait time. At a given time, each sampled
trajectory could have experienced a different number of total moves, depending on the
actual wait times experienced.</p>

    <p>That is, the number of left/right moves of the particles at a given time is a “hidden variable”,
thus using again <strong>marginalization</strong>!</p>

    <p>The probability of being at position \(x\) at time \(t\), \(P(x\mid t)\), could be the result
of an arbitrary number of \(N\) moves,</p>

\[P(x\mid t) = \sum_{N=0}^{\infty} P(x, N\mid t) = \sum_N  P(x\mid N)\ P(N\mid t)\]

    <p>The first term is the same as for the simpler case, that is a
Binomial distribution that calculates of being at position \(x\)
after \(N\) total moves.</p>

    <p>The second term, calculates the probability that at time \(t\), the
particle has experienced \(m\) left/right moves.</p>

    <p>In the simpler case we studied in class of no wait time,</p>

\[P(N\mid t) = \delta \left( N=\frac{t}{\tau}\right),\]

    <p>where the delta function indicates that the probabity takes value one for \(N=\frac{t}{\tau}\),
and zero otherwise.</p>

    <p>For our case in which the wait times follow an exponential distribution, that
probability density is given by a Poisson distribution of parameter
\(t/\lambda\) (not an obvious result that you can find for instance
<a href="CTRW.pdf">here, bottom of page 2</a>).</p>

\[P(N\mid t) = \left(\frac{t}{\lambda}\right)^N \frac{e^{-t/\lambda}}{N!}.\]

    <p>Combining the two together we have</p>

\[P(x\mid t) = \sum_{N=0}^{\infty}
\frac{N!}{\left(\frac{N-x}{2}\right)!\left(\frac{N+x}{2}\right)!} \left(\frac{1}{2}\right)^N
\left(\frac{t}{\lambda}\right)^N \frac{e^{-t/\lambda}}{N!}.\]

    <p>Using this distribution, you can calculate the analytic expression for the mean and variance
and compare with your experimental results.</p>

    <p>It may look intimidating, but think about it, the dependence in “\(x\)” is only in the “binomial” component,
and  you can change the order in which you perform the sum in “\(x\)” and the sum in “\(N\)”.</p>

    <p>The type of Brownian motion described here, and even more general
cases with different wait time distributions are referred to as
continuous time random walks (CTRW).</p>
  </li>
</ul>


 
    <footer>
      <hr>
      <p>
        <a href="http://rivaslab.org">Elena Rivas</a> | Harvard University
    </footer>
 
  </div>
</body>
</html>
