<!DOCTYPE html>
<html>
  <head>
  <meta charset=utf-8 />
  <title>  MCB111 Mathematics in Biology </title>
  <link rel="stylesheet" href="/Harvard-MCB111-2024-Fall/css/style.css" />
</head>

<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<body>
  <div id="main">
 
    <header>
      <h3> MCB111: Mathematics in Biology (Fall 2024) </h3>
    </header>
 
    <nav role="navigation"> 
      <a href="/Harvard-MCB111-2024-Fall">Home</a>  | <a href="/Harvard-MCB111-2024-Fall/schedule.html">Schedule</a> | <a href="https://canvas.harvard.edu/courses/139673/">Canvas</a> | <a href="https://piazza.com/harvard/fall2024/mcb111">Piazza</a> | <a href="/downloads/MCB111-syllabus.pdf">Syllabus [PDF]</a> | <a href="/downloads/StudentHours_2024.pdf">Student hours schedule [PDF]</a> <br/>
      
      Lectures:
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-lecture.html"> w00 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-lecture.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-lecture.html"> w02 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-lecture.html"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-lecture.html"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-lecture.html"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-lecture.html"> w06 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-lecture.html"> w07 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-lecture.html"> w08 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-lecture.html"> w09 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-lecture.html"> w10 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w11/w11-lecture.html"> w11 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w12/w12-lecture.html"> w12 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w13/w13-lecture.html"> w13 </a> |
      <br/>
      
      inclass-notes:
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-notes-lecture1.pdf"> w02-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-notes-lecture2.pdf"> w02-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-notes-lecture1.pdf"> w03-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-notes-l1.pdf"> w04-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-notes-lectures.pdf"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-notes-l1.pdf"> w06-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-notes-l2.pdf"> w06-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-notes-l1.pdf"> w07-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-notes-l2.pdf"> w07-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-notes-l1.pdf"> w08-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-notes-l2.pdf"> w08-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-notes-l1.pdf"> w09-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-notes-l2.pdf"> w09-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-notes-l1.pdf"> w10-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-notes-l2.pdf"> w10-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-notes-l3.pdf"> w10-l3 </a> |
       <br/>
      
      inclass-code: 
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-inclass.html"> w00 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-sections_er_2024_complete.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-lecture1.html"> w02-l1 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-lecture2.html"> w02-l2 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-lecture-code.ipynb"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-lecture-code.ipynb"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w13/w13-code.ipynb"> w13 </a> |
      <br/>
      
      Sections: 
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-sections.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-sections.html"> w02 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-sections_NH_2024.ipynb"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-sections_2024.ipynb"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-sections_2024.ipynb"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-sections_2024.ipynb"> w08 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-sections_2024-ER.ipynb"> w09 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-sections_2024-NH.ipynb"> w10 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w11/w11-sections_2024_er.ipynb"> w11 </a> |
     <br/>
      
      
      Homeworks:
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-homework.html"> w00 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w01/w01-homework.html"> w01 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w02/w02-homework.html"> w02 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w03/w03-homework.html"> w03 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w04/w04-homework.html"> w04 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w05/w05-homework.html"> w05 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w06/w06-homework.html"> w06 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w07/w07-homework.html"> w07 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w08/w08-homework.html"> w08 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w09/w09-homework.html"> w09 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w10/w10-homework.html"> w10 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w11/w11-homework.html"> w11 </a> |
      <a href="/Harvard-MCB111-2024-Fall/w13/w13-homework.html"> w13 </a> |
     <br/>
      
      Hints: 
      <a href="/Harvard-MCB111-2024-Fall/w00/w00-hints.html"> w00 </a> |
      <br/>
      

      Final:
      <br/>
 
     </nav>
    
    <br/>
 
    <ul id="markdown-toc">
  <li><a href="#stochastic-simulation-of-transcriptional-bursting" id="markdown-toc-stochastic-simulation-of-transcriptional-bursting">Stochastic simulation of transcriptional bursting</a>    <ul>
      <li><a href="#sampling-fast-from--an-exponential-distribution" id="markdown-toc-sampling-fast-from--an-exponential-distribution">Sampling fast from  an exponential distribution</a></li>
      <li><a href="#implementing-the-gillespie-algorithm" id="markdown-toc-implementing-the-gillespie-algorithm">Implementing the Gillespie algorithm</a></li>
    </ul>
  </li>
</ul>

<h1 class="no_toc" id="week-10">week 10:</h1>

<h1 class="no_toc" id="molecular-population-dynamics-as-a-markov-process">Molecular Population Dynamics as a Markov Process</h1>

<h2 id="stochastic-simulation-of-transcriptional-bursting">Stochastic simulation of transcriptional bursting</h2>

<h3 id="sampling-fast-from--an-exponential-distribution">Sampling fast from  an exponential distribution</h3>

<p>In the Gillespie algorithm, dwell times \(\tau\) follow a exponential
distribution.</p>

<p>The probability density function (PDF) is</p>

\[PDF(t) = W_R e^{-W_R\ t}.\]

<p>In order to sample a dwell time \(\tau\), we used the cumulative probability function (CDF)</p>

\[CDF(\tau) = \int_0^{\tau} W_R\ e^{-W_R\ t}\ dt\]

<p>such that for  a random number \(0\leq x\leq 1\),
 the sampled dwell \(\tau\) time is given by</p>

\[x = CDF(\tau).\]

<p>The CDF of the exponential distribution has a closed form given by</p>

\[CDF(\tau) = \int_0^{\tau} W_R\ e^{-W_R\ t} = 1 - e^{-W_R\ \tau}.\]

<p>Then, the sampled time is given by</p>

\[\tau = -\frac{1}{W_R}\ \log(1-x).\]

<p>If \(x\) is a random number in \([0,1]\), then \(1-x\) is also a
random number in the same range, then we can take the sampled dwell
time \(\tau\) given by</p>

\[\tau = -\frac{1}{W_R}\ \log(x).\]

<h3 id="implementing-the-gillespie-algorithm">Implementing the Gillespie algorithm</h3>

<p>For the stochastic process described in Figure 1, the reactions are given by</p>

<div id="figcontainer">
   <div id="figure">
	<img src="Fig-GeneRegulation.png" style="width:300px;" /> <br />
   Figure 1. Regulation of a single gene, transcription and translation,
   as well as RNA and Protein degradation processes.
   </div>
 </div>

<table>
  <thead>
    <tr>
      <th><em>r</em></th>
      <th><em>reaction</em></th>
      <th>propensity \(w_r\)</th>
      <th>\(\eta(R)\)</th>
      <th>\(\eta(P)\)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>\(\mbox{Gene(I)} \overset{k_b}{\longrightarrow}  \mbox{Gene(A)}\)</td>
      <td>\(k_b\)</td>
      <td>\(0\)</td>
      <td>\(0\)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>\(\mbox{Gene(A)} \overset{k_u}{\longrightarrow}  \mbox{Gene(I)}\)</td>
      <td>\(k_u\)</td>
      <td>\(0\)</td>
      <td>\(0\)</td>
    </tr>
    <tr>
      <td>3</td>
      <td>\(\mbox{Gene(A)} \overset{k_1}{\longrightarrow}  RNA\)</td>
      <td>\(k_1\)</td>
      <td>\(+1\)</td>
      <td>\(0\)</td>
    </tr>
    <tr>
      <td>4</td>
      <td>\(RNA            \overset{k_2}{\longrightarrow}  \emptyset\)</td>
      <td>\(k_2 R\)</td>
      <td>\(-1\)</td>
      <td>\(0\)</td>
    </tr>
    <tr>
      <td>5</td>
      <td>\(RNA            \overset{k_3}{\longrightarrow}  Protein\)</td>
      <td>\(k_3 R\)</td>
      <td>\(0\)</td>
      <td>\(+1\)</td>
    </tr>
    <tr>
      <td>6</td>
      <td>\(Protein        \overset{k_4}{\longrightarrow}  \emptyset\)</td>
      <td>\(k_4 P\)</td>
      <td>\(0\)</td>
      <td>\(-1\)</td>
    </tr>
  </tbody>
</table>

<p>Then the Gillespie algorithm works as follows</p>

<ul>
  <li>
    <p>Initialize at \(t = 0\),</p>

\[\begin{aligned}
Gact &amp;= 1,\\		
R &amp;= 0,\\
P &amp;= 0.\\
\end{aligned}\]
  </li>
  <li>
    <p>Keep a current count of \(t\),  \(Gact\), \(R\) and \(P\).</p>

    <ul>
      <li>\(Gact = 1\) if the gene is active (A) at time \(t\), or</li>
      <li>\(Gact = 0\) if the gene is inactive (I) at time \(t\).</li>
      <li>\(R\) is the number of RNA molecules at time \(t\).</li>
      <li>\(P\) is the number of protein molecules at time \(t\).</li>
    </ul>
  </li>
  <li>
    <p>Sample a dwell time \(\tau\) from a exponential distribution</p>

\[W_R\ e^{-W_R\ t},\]

    <p>where the total propensity is given by</p>

\[\begin{aligned}
W_R = w_1 +  w_4 + w_5 + w_6,\quad &amp;\mbox{if}\, Gact = 0,\\
W_R = w_2 + w_3 + w_4 + w_5 + w_6,\quad &amp;\mbox{if}\, Gact = 1.\\
\end	{aligned}\]
  </li>
  <li>
    <p>Update the current time \(t\) as</p>
  </li>
</ul>

\[t\rightarrow t+\tau.\]

<ul>
  <li>
    <p>Sample one reaction \(r\) according to their propensities</p>

\[P(r) = \frac{w_r}{W_R}.\]
  </li>
  <li>
    <p>Update \(Gact\), \(R\) and \(P\)</p>

    <ul>
      <li>
        <p>If \(r = 1\), then \(Gact=0 \rightarrow 1\)</p>
      </li>
      <li>
        <p>If \(r = 2\), then \(Gact=1 \rightarrow 0\)</p>
      </li>
      <li>
        <p>If \(r = 3\), then \(R \rightarrow R+1\)</p>
      </li>
      <li>
        <p>If \(r = 4\), then \(R \rightarrow R-1\)</p>
      </li>
      <li>
        <p>If \(r = 5\), then \(P \rightarrow P+1\)</p>
      </li>
      <li>
        <p>If \(r = 6\), then \(P \rightarrow P-1\)</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Update the propensities according to the new values of \(Gact\),
\(R\) and \(P\).</p>
  </li>
  <li>
    <p>Go back to sampling a new dwell time, until a maximum time \(T\).</p>
  </li>
</ul>

 
    <footer>
      <hr>
      <p>
        <a href="http://rivaslab.org">Elena Rivas</a> | Harvard University
    </footer>
 
  </div>
</body>
</html>
